sudo: required
dist: trusty
language: python

python:
  - "3.4"

before_install:
  - sudo apt-get update -qq
  - >
    sudo apt-get install -qq --install-recommends
    git-buildpackage devscripts build-essential python3-dev
    libsnmp-dev python3-yaml python3-mock python3

install:
  - sudo pip3 install coveralls

script:
  - make deb

after_success:
  - coveralls

before_deploy:
  - gem install mime-types -v 2.6.2
deploy:
  provider: releases
  api_key:
    secure: eISBbJNB5f9PrKz4fwrnNrvunJHX2cZh2XXnORJ6bO7AAecaMOKJk1IAZd4TDb0UCqwFbp96P5JmC8Q8H/k/dD7QRV2IfXbbZ4E82OS7A3fVJ9x+0nq9KjsXWvxli38+PgUtHsAo9JAxEY5yvMLAp9DcX2YqxcK7kzG1FvD50SA=
  file_glob: true
  file: "../*.deb"
  on:
    tags: true
    repo: dhtech/dhmon
